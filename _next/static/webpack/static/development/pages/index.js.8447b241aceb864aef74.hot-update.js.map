{"version":3,"file":"static/webpack/static/development/pages/index.js.8447b241aceb864aef74.hot-update.js","sources":["webpack:///./pages/index.js"],"sourcesContent":["import React from 'react'\nconst { Octokit } = require('@octokit/rest')\n\nconst octokit = new Octokit({\n  auth: '501d530a159fc4fb7f946263b91fc509a11c6d85'\n})\n\nclass Index extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      items: [],\n      posts: [],\n      downloads: [],\n      postsMax: 20,\n      downloadsMax: 20,\n      detail: null,\n      postDetail: null,\n      downloadDetail: null,\n    }\n  }\n\n  componentDidMount() {\n    window.App = this\n    this.octokit = octokit\n    this.getData()\n  }\n\n  async getData() {\n    const res = await this.octokit.repos.getContent({\n      owner: 'ryosuzuki',\n      repo: 'monitor-db',\n      path: 'db.json',\n      headers: {\n        'If-None-Match': ''\n      }\n    })\n    try {\n      let items = JSON.parse(atob(res.data.content))\n      items = items.reverse()\n      console.log(items)\n      let posts = items.filter((item => item.type == 'post'))\n      let downloads = items.filter((item => item.type !== 'post'))\n      this.setState({ items: items, posts: posts, downloads: downloads })\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  onClick(type, index) {\n    console.log(type, index)\n  }\n\n  timeFormat(timestamp) {\n    const time = new Date(timestamp)\n    let year = time.getFullYear()\n    let month = '' + (time.getMonth() + 1)\n    let day = '' + time.getDate()\n    let hour = '' + time.getHours()\n    let min = '' + time.getMinutes()\n    if (month.length < 2)\n      month = '0' + month\n    if (day.length < 2)\n      day = '0' + day\n    if (hour.length < 2)\n      hour = '0' + hour\n    if (min.length < 2)\n      min = '0' + min\n    return `${year}-${month}-${day} ${hour}:${min}`\n  }\n\n  render() {\n    return (\n      <div>\n        <title>Monitor</title>\n        <style>\n        </style>\n        <div className=\"ui two column centered grid\">\n          <div className=\"column\">\n            <h1>Monitor</h1>\n\n            <h1>Post</h1>\n            <table className=\"ui unstackable table\">\n              <thead>\n                <tr>\n                  <th className=\"status \">Status</th>\n                  <th className=\"timestamp\">Time</th>\n                  <th>Blog</th>\n                </tr>\n              </thead>\n              <tbody>\n                { this.state.posts.slice(0, this.state.postsMax).map((post, i) => {\n                  return (\n                    <tr key={ i } className={ post.error ? 'item negative' : 'item positive' } onClick={ this.onClick.bind(this, 'post', i) }>\n                      <td className=\"status center aligned\">\n                        <i className={ post.error ? 'icon close' : 'icon checkmark' } />\n                      </td>\n                      <td className=\"timestamp\">{ this.timeFormat(post.timestamp) }</td>\n                      { !post.error &&\n                        <td data-label=\"blog\">{ post.data.item.article }</td>\n                      }\n                      { post.error &&\n                        <td data-label=\"blog\">{ post.data.blog }</td>\n                      }\n                    </tr>\n                  )\n                })}\n              </tbody>\n            </table>\n\n            <pre>{ this.state.postDetail }</pre>\n\n            <h1>Downloads</h1>\n            <table className=\"ui unstackable table\">\n              <thead>\n                <tr>\n                  <th className=\"status\">Status</th>\n                  <th className=\"timestamp\">Time</th>\n                  <th>Key</th>\n                </tr>\n              </thead>\n              <tbody>\n                { this.state.downloads.slice(0, this.state.downloadsMax).map((download, i) => {\n                  return (\n                    <tr key={ i } className={ download.error ? 'item negative' : 'item positive' } onClick={ this.onClick.bind(this, 'crawl', i) }>\n                      <td className=\"status center aligned\">\n                        <i className={ download.error ? 'icon close' : 'icon checkmark' } />\n                      </td>\n                      <td className=\"timestamp\">{ this.timeFormat(download.timestamp) }</td>\n                      <td data-label=\"key\">{ download.data.key }</td>\n                    </tr>\n                  )\n                })}\n              </tbody>\n            </table>\n            <pre>{ JSON.stringify(this.state.downloadDetail, null, 2) }</pre>\n\n            <div className=\"ui modal\">\n              <div className=\"header\">Header</div>\n              <div className=\"content\">\n                <p>fafjaeojfaoie</p>\n              </div>\n              <div className=\"actions\">\n                <div className=\"ui approve button\">Approve</div>\n                <div className=\"ui button\">Neutral</div>\n                <div className=\"ui cancel button\">Cancel</div>\n              </div>\n            </div>\n\n\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Index"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AADA;AACA;AAGA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAFA;AAYA;AACA;;;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;AAGA;AACA;AACA;AACA;AACA;AACA;AADA;AAJA;AACA;;AADA;AACA;AAOA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AACA;;;AAEA;AAAA;AACA;AAAA;AAKA;AAAA;AACA;AAAA;AAIA;AAAA;AAGA;AAAA;AACA;AAAA;AAMA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AAEA;AAAA;AAGA;AAAA;AAIA;AAOA;AAAA;AAGA;AAAA;AACA;AAAA;AAMA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAGA;AAKA;AAAA;AACA;AAAA;AACA;AAAA;AAGA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AASA;;;;AAnJA;AACA;AAqJA;;;;A","sourceRoot":""}